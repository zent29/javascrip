<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Login</title>
    <style>
      /* Reseteo m√≠nimo y tipograf√≠a */
      body { font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Arial; background:#e9e7ea; margin:0; padding:2rem; display:flex; align-items:center; justify-content:center; min-height:100vh; }

      /* Tarjeta centrada con borde redondeado similar a la imagen */
      .card { background:#fff; padding:2rem; border-radius:12px; box-shadow:0 8px 30px rgba(0,0,0,0.08); width:360px; }
      .card-title { text-align:center; margin:0 0 1.25rem 0; font-size:1.25rem; }

      /* Estilos de campos con icono dentro */
      .form .field { position:relative; display:flex; align-items:center; margin-bottom:0.9rem; }
      .form .field .icon { display:inline-flex; align-items:center; justify-content:center; width:44px; height:40px; background:#f3f4f6; border-radius:8px; margin-right:0.5rem; font-size:18px }
      .form .field input { flex:1; padding:0.6rem; border:1px solid #e2e2e2; border-radius:8px; background:transparent; }
      .form .field input::placeholder { color:#9ca3af }
      .form .field .eye { margin-left:0.5rem; border:0;background:transparent; cursor:pointer }

      /* Bot√≥n grande similar al dise√±o */
      .big-btn { width:100%; padding:0.85rem; border-radius:8px; border:0; background:linear-gradient(#d1d5db,#e5e7eb); font-weight:700; color:#111; box-shadow:0 6px 18px rgba(0,0,0,0.06); }

      .small { text-align:center; font-size:0.85rem; color:#6b7280; margin-top:0.85rem }

      .error{color:#b91c1c;margin-bottom:0.5rem}
    </style>
  </head>
  <body>
    <div class="card">
      <!-- T√≠tulo grande centrado similar al dise√±o mostrado -->
      <h2 class="card-title">Registro de Usuario</h2>

      <!-- Contenedor de formulario con iconos dentro de los inputs -->
      <form id="loginForm" class="form">
        <div id="error" class="error" aria-live="polite" style="display:none"></div>

        <div class="field">
          <span class="icon">üë§</span>
          <input id="user" name="user" placeholder="Usuario" autocomplete="username" required />
        </div>

        <!-- campo de correo eliminado seg√∫n petici√≥n del usuario -->

        <div class="field">
          <span class="icon">üîí</span>
          <input id="pass" name="pass" type="password" placeholder="Contrase√±a" autocomplete="current-password" required />
          <button type="button" id="togglePass" class="eye" aria-label="Mostrar contrase√±a">‚ó∑</button>
        </div>

        <button type="submit" class="big-btn">REGISTRARSE</button>

        <p class="small">¬øYa tienes cuenta? <a href="#">¬°Inicia sesi√≥n aqu√≠!</a></p>
      </form>
    </div>

    <!-- Incluir el m√≥dulo de autenticaci√≥n centralizado -->
    <script src="auth.js"></script>
    <script>
      // Toggle de visibilidad de contrase√±a (mejora UI)
      document.addEventListener('click', function(e){
        if(e.target && e.target.id === 'togglePass'){
          const pass = document.getElementById('pass');
          if(pass.type === 'password') pass.type = 'text'; else pass.type = 'password';
        }
      });

      // Obtener referencias a elementos del DOM
      const form = document.getElementById('loginForm');
      const errorDiv = document.getElementById('error');

      // Manejar el evento submit del formulario
      form.addEventListener('submit', function(e){
        e.preventDefault(); // evitar env√≠o cl√°sico y recarga
        // leer valores de los campos
        const user = document.getElementById('user').value.trim();
        const pass = document.getElementById('pass').value;

        // Usar Auth.login para validar y guardar sesi√≥n si corresponde
        if(Auth.login(user, pass)){
          // Credenciales v√°lidas: redirigir a la p√°gina protegida
          window.location.href = 'p1.html';
        } else {
          // Credenciales inv√°lidas: mostrar error y limpiar contrase√±a
          errorDiv.textContent = 'Usuario o contrase√±a incorrectos. Vuelva a intentarlo.';
          errorDiv.style.display = 'block';
          document.getElementById('pass').value = '';
          document.getElementById('pass').focus();
        }
      });

      // Mostrar mensajes pasados por query string (ej. ?logged=0 al cerrar sesi√≥n)
      (function showQueryMessages(){
        const params = new URLSearchParams(window.location.search);
        if(params.get('logged') === '0'){
          // Mostrar mensaje informativo sobre logout
          errorDiv.textContent = 'Sesi√≥n cerrada. Inicie sesi√≥n de nuevo.';
          errorDiv.style.display = 'block';
        }
      })();
    </script>
  </body>
</html>
